CREATE DATABASE Samples_Population
GO

USE Samples_Population
GO

CREATE TABLE Populations (
ID INT PRIMARY KEY,
Name VARCHAR(50),
PopulationIn2000 BIGINT,
PopulationIn2001 BIGINT,
PopulationIn2002 BIGINT,
PopulationIn2003 BIGINT,
PopulationIn2004 BIGINT,
PopulationIn2005 BIGINT,
PopulationIn2006 BIGINT,
PopulationIn2007 BIGINT,
PopulationIn2008 BIGINT,
PopulationIn2009 BIGINT,
PopulationIn2010 BIGINT,
PopulationIn2011 BIGINT,
PopulationIn2012 BIGINT,
PopulationIn2013 BIGINT,
PopulationIn2014 BIGINT,
PopulationIn2015 BIGINT,
PopulationIn2016 BIGINT,
PopulationIn2017 BIGINT,
PopulationIn2018 BIGINT,
PopulationIn2019 BIGINT,
PopulationIn2020 BIGINT,
AreaInKm2 INT)


---Insert the data into created table
INSERT INTO Populations (ID, NAME, PopulationIn2000, PopulationIn2001, PopulationIn2002, PopulationIn2003, PopulationIn2004, PopulationIn2005, PopulationIn2006, PopulationIn2007, PopulationIn2008, PopulationIn2009, PopulationIn2010, PopulationIn2011, PopulationIn2012, PopulationIn2013, PopulationIn2014, PopulationIn2015, PopulationIn2016, PopulationIn2017, PopulationIn2018, PopulationIn2019, PopulationIn2020, AreaInKM2)
VALUES
    (1, 'Asia', 3714470000, 3760799239, 3807128478, 3853457716, 3899786955, 3946116194, 3992445433, 4038774671, 4085103910, 4131433149, 4177762388, 4224091626, 4270420865, 4316750104, 4363079343, 4409408581, 4455737820, 4502067059, 4548396298, 4594725536, 4641054775, 31033131),
    (2, 'Africa', 814063000, 840389757, 866716515, 893043272, 919370029, 945696787, 972023544, 998350301, 1024677059, 1051003816, 1077330574, 1103657331, 1129984088, 1156310846, 1182637603, 1208964360, 1235291118, 1261617875, 1287944632, 1314271390, 1340598147, 29648481),
    (3, 'Europe', 726407000, 727468451, 728529903, 729591354, 730652805, 731714257, 732775708, 733837159, 734898610, 735960062, 737021513, 738082964, 739144416, 740205867, 741267318, 742328769, 743390221, 744451672, 745513123, 746574575, 747636026, 22134900),
    (4, 'North America', 490818000, 495880711, 500943421, 506006132, 511068842, 516131553, 521194264, 526256974, 531319685, 536382395, 541445106, 546507817, 551570527, 556633238, 561695948, 566758659, 571821370, 576884080, 581946791, 587009501, 592072212, 21330000),
    (5, 'South America', 349796000, 353844188, 357892377, 361940565, 365988753, 370036942, 374085130, 378133318, 382181506, 386229695, 390277883, 394326071, 398374260, 402422448, 406470636, 410518825, 414567013, 418615201, 422663389, 426711578, 430759766, 17461112),
    (6, 'Australia/Oceania', 31068000, 31670185, 32272370, 32874556, 33476741, 34078926, 34681111, 35283296, 35885482, 36487667, 37089852, 37692037, 38294222, 38896408, 39498593, 40100778, 40702963, 41305148, 41907334, 42509519, 43111704, 8486460),
    (7, 'Antarctica', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13720000);


--select * from populations;

  ---TASK 1---
  SELECT NAME AS Continent,
  CAST(CAST(AreaInKM2 AS DECIMAL(10,2))/(SELECT SUM(AreaInKM2) FROM Populations) *100 AS DECIMAL(10,2)) AS Share
  FROM Populations
  GROUP BY Name, AreaInKM2
  ORDER BY Share DESC;
 
